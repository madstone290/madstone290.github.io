(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))n(f);new MutationObserver(f=>{for(const i of f)if(i.type==="childList")for(const x of i.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&n(x)}).observe(document,{childList:!0,subtree:!0});function r(f){const i={};return f.integrity&&(i.integrity=f.integrity),f.referrerPolicy&&(i.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?i.credentials="include":f.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(f){if(f.ep)return;f.ep=!0;const i=r(f);fetch(f.href,i)}})();var ln=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cn(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var It={exports:{}};(function(c,p){(function(r,n){c.exports=n()})(ln,function(){var r=1e3,n=6e4,f=36e5,i="millisecond",x="second",D="minute",O="hour",j="day",oe="week",U="month",K="quarter",A="year",J="date",ie="Invalid Date",fe=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Le=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_e={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(_){var C=["th","st","nd","rd"],v=_%100;return"["+_+(C[(v-20)%10]||C[v]||C[0])+"]"}},ve=function(_,C,v){var T=String(_);return!T||T.length>=C?_:""+Array(C+1-T.length).join(v)+_},he={s:ve,z:function(_){var C=-_.utcOffset(),v=Math.abs(C),T=Math.floor(v/60),h=v%60;return(C<=0?"+":"-")+ve(T,2,"0")+":"+ve(h,2,"0")},m:function _(C,v){if(C.date()<v.date())return-_(v,C);var T=12*(v.year()-C.year())+(v.month()-C.month()),h=C.clone().add(T,U),y=v-h<0,L=C.clone().add(T+(y?-1:1),U);return+(-(T+(v-h)/(y?h-L:L-h))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:U,y:A,w:oe,d:j,D:J,h:O,m:D,s:x,ms:i,Q:K}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},le="en",se={};se[le]=_e;var xe="$isDayjsObject",ge=function(_){return _ instanceof te||!(!_||!_[xe])},ue=function _(C,v,T){var h;if(!C)return le;if(typeof C=="string"){var y=C.toLowerCase();se[y]&&(h=y),v&&(se[y]=v,h=y);var L=C.split("-");if(!h&&L.length>1)return _(L[0])}else{var $=C.name;se[$]=C,h=$}return!T&&h&&(le=h),h||!T&&le},G=function(_,C){if(ge(_))return _.clone();var v=typeof C=="object"?C:{};return v.date=_,v.args=arguments,new te(v)},R=he;R.l=ue,R.i=ge,R.w=function(_,C){return G(_,{locale:C.$L,utc:C.$u,x:C.$x,$offset:C.$offset})};var te=function(){function _(v){this.$L=ue(v.locale,null,!0),this.parse(v),this.$x=this.$x||v.x||{},this[xe]=!0}var C=_.prototype;return C.parse=function(v){this.$d=function(T){var h=T.date,y=T.utc;if(h===null)return new Date(NaN);if(R.u(h))return new Date;if(h instanceof Date)return new Date(h);if(typeof h=="string"&&!/Z$/i.test(h)){var L=h.match(fe);if(L){var $=L[2]-1||0,B=(L[7]||"0").substring(0,3);return y?new Date(Date.UTC(L[1],$,L[3]||1,L[4]||0,L[5]||0,L[6]||0,B)):new Date(L[1],$,L[3]||1,L[4]||0,L[5]||0,L[6]||0,B)}}return new Date(h)}(v),this.init()},C.init=function(){var v=this.$d;this.$y=v.getFullYear(),this.$M=v.getMonth(),this.$D=v.getDate(),this.$W=v.getDay(),this.$H=v.getHours(),this.$m=v.getMinutes(),this.$s=v.getSeconds(),this.$ms=v.getMilliseconds()},C.$utils=function(){return R},C.isValid=function(){return this.$d.toString()!==ie},C.isSame=function(v,T){var h=G(v);return this.startOf(T)<=h&&h<=this.endOf(T)},C.isAfter=function(v,T){return G(v)<this.startOf(T)},C.isBefore=function(v,T){return this.endOf(T)<G(v)},C.$g=function(v,T,h){return R.u(v)?this[T]:this.set(h,v)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(v,T){var h=this,y=!!R.u(T)||T,L=R.p(v),$=function(s,l){var a=R.w(h.$u?Date.UTC(h.$y,l,s):new Date(h.$y,l,s),h);return y?a:a.endOf(j)},B=function(s,l){return R.w(h.toDate()[s].apply(h.toDate("s"),(y?[0,0,0,0]:[23,59,59,999]).slice(l)),h)},W=this.$W,V=this.$M,z=this.$D,de="set"+(this.$u?"UTC":"");switch(L){case A:return y?$(1,0):$(31,11);case U:return y?$(1,V):$(0,V+1);case oe:var re=this.$locale().weekStart||0,me=(W<re?W+7:W)-re;return $(y?z-me:z+(6-me),V);case j:case J:return B(de+"Hours",0);case O:return B(de+"Minutes",1);case D:return B(de+"Seconds",2);case x:return B(de+"Milliseconds",3);default:return this.clone()}},C.endOf=function(v){return this.startOf(v,!1)},C.$set=function(v,T){var h,y=R.p(v),L="set"+(this.$u?"UTC":""),$=(h={},h[j]=L+"Date",h[J]=L+"Date",h[U]=L+"Month",h[A]=L+"FullYear",h[O]=L+"Hours",h[D]=L+"Minutes",h[x]=L+"Seconds",h[i]=L+"Milliseconds",h)[y],B=y===j?this.$D+(T-this.$W):T;if(y===U||y===A){var W=this.clone().set(J,1);W.$d[$](B),W.init(),this.$d=W.set(J,Math.min(this.$D,W.daysInMonth())).$d}else $&&this.$d[$](B);return this.init(),this},C.set=function(v,T){return this.clone().$set(v,T)},C.get=function(v){return this[R.p(v)]()},C.add=function(v,T){var h,y=this;v=Number(v);var L=R.p(T),$=function(V){var z=G(y);return R.w(z.date(z.date()+Math.round(V*v)),y)};if(L===U)return this.set(U,this.$M+v);if(L===A)return this.set(A,this.$y+v);if(L===j)return $(1);if(L===oe)return $(7);var B=(h={},h[D]=n,h[O]=f,h[x]=r,h)[L]||1,W=this.$d.getTime()+v*B;return R.w(W,this)},C.subtract=function(v,T){return this.add(-1*v,T)},C.format=function(v){var T=this,h=this.$locale();if(!this.isValid())return h.invalidDate||ie;var y=v||"YYYY-MM-DDTHH:mm:ssZ",L=R.z(this),$=this.$H,B=this.$m,W=this.$M,V=h.weekdays,z=h.months,de=h.meridiem,re=function(l,a,u,E){return l&&(l[a]||l(T,y))||u[a].slice(0,E)},me=function(l){return R.s($%12||12,l,"0")},s=de||function(l,a,u){var E=l<12?"AM":"PM";return u?E.toLowerCase():E};return y.replace(Le,function(l,a){return a||function(u){switch(u){case"YY":return String(T.$y).slice(-2);case"YYYY":return R.s(T.$y,4,"0");case"M":return W+1;case"MM":return R.s(W+1,2,"0");case"MMM":return re(h.monthsShort,W,z,3);case"MMMM":return re(z,W);case"D":return T.$D;case"DD":return R.s(T.$D,2,"0");case"d":return String(T.$W);case"dd":return re(h.weekdaysMin,T.$W,V,2);case"ddd":return re(h.weekdaysShort,T.$W,V,3);case"dddd":return V[T.$W];case"H":return String($);case"HH":return R.s($,2,"0");case"h":return me(1);case"hh":return me(2);case"a":return s($,B,!0);case"A":return s($,B,!1);case"m":return String(B);case"mm":return R.s(B,2,"0");case"s":return String(T.$s);case"ss":return R.s(T.$s,2,"0");case"SSS":return R.s(T.$ms,3,"0");case"Z":return L}return null}(l)||L.replace(":","")})},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(v,T,h){var y,L=this,$=R.p(T),B=G(v),W=(B.utcOffset()-this.utcOffset())*n,V=this-B,z=function(){return R.m(L,B)};switch($){case A:y=z()/12;break;case U:y=z();break;case K:y=z()/3;break;case oe:y=(V-W)/6048e5;break;case j:y=(V-W)/864e5;break;case O:y=V/f;break;case D:y=V/n;break;case x:y=V/r;break;default:y=V}return h?y:R.a(y)},C.daysInMonth=function(){return this.endOf(U).$D},C.$locale=function(){return se[this.$L]},C.locale=function(v,T){if(!v)return this.$L;var h=this.clone(),y=ue(v,T,!0);return y&&(h.$L=y),h},C.clone=function(){return R.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},_}(),ce=te.prototype;return G.prototype=ce,[["$ms",i],["$s",x],["$m",D],["$H",O],["$W",j],["$M",U],["$y",A],["$D",J]].forEach(function(_){ce[_[1]]=function(C){return this.$g(C,_[0],_[1])}}),G.extend=function(_,C){return _.$i||(_(C,te,G),_.$i=!0),G},G.locale=ue,G.isDayjs=ge,G.unix=function(_){return G(1e3*_)},G.en=se[le],G.Ls=se,G.p={},G})})(It);var dn=It.exports;const Je=cn(dn),rt="/PlumChart/assets/close-8d2bdc87.svg",un="/PlumChart/assets/black-error-8086e7bd.svg";window.plumChartGlobal={debug:!1};const at="tc-root",lt="tc-column-title",ct="tc-column-header-box",dt="tc-column-header",ut="tc-side-canvas-box",mt="tc-side-canvas",mn="tc-column-header-item",fn="tc-column-panel",vn="tc-left-panel",hn="tc-main-panel",ft="tc-maintitle",vt="tc-table-column-box",ht="tc-entity-table-box",Cn="tc-entity-table-item",pn="tc-main-box",Ct="tc-main-canvas-box",pt="tc-main-canvas",gt="tc-side-canvas-v-border",gn="tc-side-canvas-point-event",En="tc-main-canvas-h-border",Tn="tc-main-canvas-v-border",Ln="tc-main-canvas-entity-point-event",_n="tc-main-canvas-entity-range-event",xn="tc-main-canvas-global-range-event",Et="tc-context-menu",yn="tc-context-menu-top-left",Sn="tc-context-menu-top-right",Mn="tc-context-menu-bottom-left",wn="tc-context-menu-bottom-right",Ie="tc-context-menu-closed",Qe="tc-context-menu-collapsed",On="tc-context-menu-group1",Rn="tc-context-menu-group2",Ee="tc-context-menu-item",Tt="tc-context-menu-item-up",Lt="tc-context-menu-item-down",_t="tc-context-menu-item-left",xt="tc-context-menu-item-right",yt="tc-context-menu-item-zoom-in",St="tc-context-menu-item-zoom-out",Mt="tc-context-menu-item-close",bn="--tc-cell-height",Nn="--tc-main-point-content-height",$n="--tc-main-range-content-height",Dn="--tc-scroll-width",In="--tc-height",Hn="--tc-width",Pn="--tc-list-width",Bn="--tc-column-title-height",An="--tc-column-header-height",Wn="--tc-side-canvas-height",Gn="--tc-side-canvas-content-height",Vn="--plc-border-color",zn="--plc-canvas-line-color",wt=new Map([["topLeft",yn],["topRight",Sn],["bottomLeft",Mn],["bottomRight",wn]]),kn=function(){const c=`
                    <div class="${at}">
                        <div class="${vn}">
                            <div class="${ft}"></div>
                            <div class="${vt}"></div>
                            <div class="${ht}"></div>
                        </div>
                        <div class="${hn}">
                            <div class="${fn}">
                                <div class="${lt}"></div>
                                <div class="${ct}">
                                    <div class="${dt}"></div>
                                </div>
                                <div class="${ut}">
                                    <div class="${mt}"></div>
                                </div>
            
                            </div>
                            <div class="${pn}">
                                <div class="${Ct}">
                                    <div class="${pt}">
                                    </div>
                                </div>
                                <div class="${Et}">
                                    <div class="${On}">
                                        <div class="${Ee} ${Tt}"></div>
                                        <div class="${Ee} ${Lt}"></div>
                                        <div class="${Ee} ${_t}"></div>
                                        <div class="${Ee} ${xt}"></div>
                                    </div>
                                    <div class="${Rn}">
                                        <div class="${Ee} ${yt}"></div>
                                        <div class="${Ee} ${St}"></div>
                                        <div class="${Ee} ${Mt}"></div>
                                    </div>
                                </div>
                            <div>
                        </div>
                    </div>
                    `,p={entities:[],sidePointEvents:[],globalRangeEvents:[]},r={chartStartTime:new Date,chartEndTime:new Date(new Date().getDate()+1),controllerLocation:"bottomRight",canvasLineColor:"#ccc",rowHoverColor:"#eee",borderColor:"#ccc",fixedController:!0,buttonScrollStepX:400,buttonScrollStepY:200,mainRangeContentRatio:.8,mainPointContentRatio:.6,sideCanvasContentHeightRatio:.6,maxZoomScale:5,minZoomScale:1,zoomScale:1,zoomChangeRate:.2,scrollLeft:0,scrollTop:0,cellMinutes:30,cellWidth:100,cellHeight:50,leftPanelWidth:200,gridTitle:"",canvasTitle:"",columnTitleHeight:30,columnHeaderHeight:30,sideCanvasHeight:30,paddingCellCount:0,scrollWidth:15,hZoomEnabled:!0,vZoomEnabled:!1,hasHorizontalLine:!0,hasVerticalLine:!0,columnAutoWidth:!0,entityEventSearchScrollOffset:-100,renderMode:"scroll",maxRenderCountPerRow:1e3,useGroupEvent:!1,groupEventWidth:50,renderGroupEvent:(e,t,o)=>(o.innerText="Group",o),customizeElements:e=>{},formatHeaderTime:e=>e.toLocaleTimeString(),renderHeaderCell:(e,t)=>{t.innerText=r.formatHeaderTime(e)},renderGridTitle:(e,t)=>{e.innerText=t},renderGridColumns:e=>{e.innerText="Column"},renderGridRow:(e,t,o)=>{o.innerText="Row #"+e},renderCanvasTitle:(e,t)=>{e.innerText=t},renderSidePointEvent:(e,t,o)=>{o.style.backgroundColor="yellow"},renderEntityPointEvent:(e,t,o)=>{o.style.backgroundColor="red"},renderEntityRangeEvent:(e,t,o)=>{o.style.backgroundColor="green"},renderGlobalRangeEvent:(e,t,o)=>{o.style.backgroundColor="blue"}},n={chartHeight:0,chartWidth:0,cellContentHeight:0,lastZoomTime:new Date,cellWidth:r.cellWidth,cellHeight:r.cellHeight,canvasColumnCount:0,originalCellWidth:0,originalCellHeight:0,chartRenderStartTime:r.chartStartTime,chartRenderEndTime:r.chartEndTime,canvasColumnVLines:[],sideCanvasVLines:[],mainCanvasVLines:[],sidePointEventItems:[],sideGroupEventElements:[],globalRangeEventItems:[],entityContainerRows:new Map,activeEntityRows:new Map},f=document.createElement("div"),i={root:f,gridTitle:f,gridColumnBox:f,canvasTitle:f,gridBox:f,canvasColumnBox:f,canvasColumn:f,sideCanvasBox:f,sideCanvas:f,mainCanvasBox:f,mainCanvas:f,contextMenu:f,upMenuItem:f,downMenuItem:f,leftMenuItem:f,rightMenuItem:f,zoomInMenuItem:f,zoomOutMenuItem:f,closeMenuItem:f};let x,D;const O=function(){function e(o){return getComputedStyle(i.root).getPropertyValue(o)}function t(o,m){i.root.style.setProperty(o,m)}return{getVariable:e,setVariable:t,setCanvasLineColor:o=>{t(zn,o)},setBorderColor:o=>{t(Vn,o)},setLeftPanelWidth:o=>{t(Pn,`${o}px`)},setChartWidth:o=>{t(Hn,`${o}px`)},setChartHeight:o=>{t(In,`${o}px`)},setColumnTitleHeight:o=>{t(Bn,`${o}px`)},setColumnHeaderHeight:o=>{t(An,`${o}px`)},setSideCanvasHeight:o=>{t(Wn,`${o}px`)},setSideCanvasContentHeight:o=>{t(Gn,`${o}px`)},setCellHeight:o=>{t(bn,`${o}px`)},setScrollWidth:o=>{t(Dn,`${o}px`)},setMainRangeContentHeight:o=>{t($n,`${o}px`)},setMainPointContentHeight:o=>{t(Nn,`${o}px`)}}}();function j(e){const m=new DOMParser().parseFromString(c,"text/html").body.firstChild;e.appendChild(m),i.root=e.getElementsByClassName(at)[0],i.gridTitle=e.getElementsByClassName(ft)[0],i.gridColumnBox=e.getElementsByClassName(vt)[0],i.canvasTitle=e.getElementsByClassName(lt)[0],i.gridBox=e.getElementsByClassName(ht)[0],i.canvasColumnBox=e.getElementsByClassName(ct)[0],i.canvasColumn=e.getElementsByClassName(dt)[0],i.sideCanvasBox=e.getElementsByClassName(ut)[0],i.sideCanvas=e.getElementsByClassName(mt)[0],i.mainCanvasBox=e.getElementsByClassName(Ct)[0],i.mainCanvas=e.getElementsByClassName(pt)[0],i.contextMenu=e.getElementsByClassName(Et)[0],i.upMenuItem=e.getElementsByClassName(Tt)[0],i.downMenuItem=e.getElementsByClassName(Lt)[0],i.leftMenuItem=e.getElementsByClassName(_t)[0],i.rightMenuItem=e.getElementsByClassName(xt)[0],i.zoomInMenuItem=e.getElementsByClassName(yt)[0],i.zoomOutMenuItem=e.getElementsByClassName(St)[0],i.closeMenuItem=e.getElementsByClassName(Mt)[0],le(),se(),oe(e.clientWidth,e.clientHeight),console.info("PlumChart created.")}function oe(e,t){n.chartWidth=e,n.chartHeight=t,O.setChartWidth(e),O.setChartHeight(t)}function U(e){n.cellHeight=e,O.setCellHeight(e),O.setMainRangeContentHeight(_e()),O.setMainPointContentHeight(ve())}function K(e){return e/(60*1e3)}function A(e){return e*60*1e3}function J(e,t,o){const m=o.getBoundingClientRect(),d=e-m.left,g=t-m.top;return{x:d,y:g}}function ie(e,t){return J(e,t,i.mainCanvas)}function fe(e,t){return J(e,t,i.mainCanvasBox)}function Le(){const e=i.mainCanvasBox.getBoundingClientRect(),t=e.left+e.width/2,o=e.top+e.height/2;return{clientX:t,clientY:o}}function _e(){return n.cellHeight*r.mainRangeContentRatio}function ve(){return n.cellHeight*r.mainPointContentRatio}function he(){return r.sideCanvasHeight*r.sideCanvasContentHeightRatio}function le(){i.mainCanvasBox.addEventListener("scroll",e=>{i.canvasColumnBox.scrollLeft=i.mainCanvasBox.scrollLeft,i.sideCanvasBox.scrollLeft=i.mainCanvasBox.scrollLeft,r.scrollLeft=i.mainCanvasBox.scrollLeft,i.gridBox.scrollTop=i.mainCanvasBox.scrollTop,r.scrollTop=i.mainCanvasBox.scrollTop}),i.gridBox.addEventListener("wheel",e=>{i.mainCanvasBox.scrollTop+=e.deltaY}),i.mainCanvas.addEventListener("mousemove",e=>{e.buttons===1&&(i.mainCanvasBox.scrollLeft-=e.movementX,i.mainCanvasBox.scrollTop-=e.movementY)}),i.mainCanvas.addEventListener("mousedown",e=>{document.body.style.cursor="pointer"}),i.mainCanvas.addEventListener("mouseup",e=>{document.body.style.cursor="default"}),i.mainCanvas.addEventListener("wheel",e=>{l(i.mainCanvas,e)}),i.sideCanvas.addEventListener("wheel",e=>{l(i.sideCanvas,e)}),document.body.addEventListener("wheel",e=>{e.ctrlKey&&e.preventDefault()},{passive:!1}),document.body.addEventListener("keydown",e=>{e.ctrlKey&&(document.body.style.cursor="pointer")}),document.body.addEventListener("keyup",e=>{document.body.style.cursor="default"})}function se(){let e,t;const d=()=>r.buttonScrollStepX,g=()=>r.buttonScrollStepY,w=()=>r.buttonScrollStepX/2,k=()=>r.buttonScrollStepY/2,Z=(Y,Q,ae,Ce,Me)=>{Y.addEventListener("mousedown",function(st){i.mainCanvasBox.scrollTo({top:i.mainCanvasBox.scrollTop+Ce(),left:i.mainCanvasBox.scrollLeft+Q(),behavior:"smooth"}),t=setTimeout(()=>{e=setInterval(()=>{i.mainCanvasBox.scrollTop+=Me(),i.mainCanvasBox.scrollLeft+=ae()},30)},300)}),Y.addEventListener("mouseup",st=>{clearInterval(e),clearTimeout(t)}),Y.addEventListener("mouseleave",st=>{clearInterval(e),clearTimeout(t)})};Z(i.upMenuItem,()=>0,()=>0,()=>-g(),()=>-k()),Z(i.downMenuItem,()=>0,()=>0,()=>g(),()=>k()),Z(i.leftMenuItem,()=>-d(),()=>-w(),()=>0,()=>0),Z(i.rightMenuItem,()=>d(),()=>w(),()=>0,()=>0),i.zoomInMenuItem.addEventListener("click",Y=>{if(r.fixedController){const{clientX:Q,clientY:ae}=Le(),{x:Ce,y:Me}=ie(Q,ae);Ue(Ce,Me)}else{const{x:Q,y:ae}=ie(Y.clientX,Y.clientY);Ue(Q,ae)}}),i.zoomOutMenuItem.addEventListener("click",Y=>{if(r.fixedController){const{clientX:Q,clientY:ae}=Le(),{x:Ce,y:Me}=ie(Q,ae);Xe(Ce,Me)}else{const{x:Q,y:ae}=ie(Y.clientX,Y.clientY);Xe(Q,ae)}}),i.closeMenuItem.addEventListener("click",Y=>{r.fixedController?i.contextMenu.classList.toggle(Qe):i.contextMenu.classList.toggle(Ie)}),i.mainCanvas.addEventListener("contextmenu",Y=>{var Ce;if((Ce=window.plumChartGlobal)!=null&&Ce.debug||Y.preventDefault(),r.fixedController)return;const{x:Q,y:ae}=fe(Y.clientX,Y.clientY);i.contextMenu.style.left=`${Q}px`,i.contextMenu.style.top=`${ae}px`,i.contextMenu.classList.remove(Ie)});let F,Ke=300;i.mainCanvas.addEventListener("touchstart",Y=>{F=setTimeout(()=>{},Ke)}),i.mainCanvas.addEventListener("touchend",Y=>{F&&clearTimeout(F)}),i.mainCanvas.addEventListener("click",Y=>{if(r.fixedController)return;const Q=Y.target;Q==i.zoomInMenuItem||Q==i.zoomOutMenuItem||i.contextMenu.classList.add(Ie)})}function xe(e){Object.assign(r,e),ue(r.chartStartTime,r.chartEndTime)}function ge(){return{...r}}function ue(e,t){r.chartStartTime=e,r.chartEndTime=t,n.chartRenderStartTime=new Date(e.valueOf()-A(r.cellMinutes*r.paddingCellCount)),n.chartRenderEndTime=new Date(t.valueOf()+A(r.cellMinutes*r.paddingCellCount))}function G(e){e.sidePointEvents.sort((t,o)=>t.time.valueOf()-o.time.valueOf()),e.globalRangeEvents.sort((t,o)=>t.startTime.valueOf()-o.startTime.valueOf());for(const t of e.entities)t.pointEvents.sort((o,m)=>o.time.valueOf()-m.time.valueOf()),t.rangeEvents.sort((o,m)=>o.startTime.valueOf()-m.startTime.valueOf());Object.assign(p,e)}function R(){return p}function te(e,t){return(t==null||n.chartRenderStartTime<=t)&&e<=n.chartRenderEndTime}function ce(e,t){const o=new Date(Math.max(e.getTime(),n.chartRenderStartTime.getTime())),m=t==null?new Date(n.chartRenderEndTime):new Date(Math.min(t.getTime(),n.chartRenderEndTime.getTime()));return[o,m]}function _(){if(wt.forEach(e=>{i.contextMenu.classList.remove(e)}),i.contextMenu.classList.remove(Ie),i.contextMenu.classList.remove(Qe),r.fixedController){i.contextMenu.classList.add(Qe);const e=wt.get(r.controllerLocation);i.contextMenu.classList.add(e)}}function C(){O.setBorderColor(r.borderColor),O.setCanvasLineColor(r.canvasLineColor),U(r.cellHeight),O.setLeftPanelWidth(r.leftPanelWidth),O.setColumnTitleHeight(r.columnTitleHeight),O.setColumnHeaderHeight(r.columnHeaderHeight),O.setSideCanvasHeight(r.sideCanvasHeight),O.setSideCanvasContentHeight(he()),O.setScrollWidth(r.scrollWidth)}function v(){n.canvasColumnCount=Math.floor((n.chartRenderEndTime.valueOf()-n.chartRenderStartTime.valueOf())/A(r.cellMinutes)),n.cellWidth=r.cellWidth,n.cellHeight=r.cellHeight,n.originalCellWidth=r.cellWidth,n.originalCellHeight=r.cellHeight,r.columnAutoWidth&&(n.originalCellWidth=i.mainCanvasBox.clientWidth/n.canvasColumnCount,n.cellWidth=n.originalCellWidth*r.zoomScale)}function T(){C(),_(),r.customizeElements({rootElement:i.root}),$(),B(),v(),h(),L(),console.info("PlumChart rendered.")}function h(){W(),V(),de(),a(),S(),X(),i.mainCanvasBox.scrollTo(i.mainCanvasBox.scrollLeft,i.mainCanvasBox.scrollTop-1),Ze(r.zoomScale),nt(r.scrollLeft,r.scrollTop)}function y(){if(r.columnAutoWidth){const e=i.mainCanvasBox.clientWidth;n.originalCellWidth=e/n.canvasColumnCount,n.cellWidth=n.originalCellWidth*r.zoomScale,ot()}}function L(){D==null||D.disconnect(),D=new ResizeObserver(y),D.observe(i.mainCanvasBox)}function $(){i.gridTitle.replaceChildren(),r.renderGridTitle(i.gridTitle,r.gridTitle)}function B(){i.gridColumnBox.replaceChildren(),r.renderGridColumns(i.gridColumnBox)}function W(){let e=Math.max(n.cellWidth*n.canvasColumnCount,i.mainCanvasBox.clientWidth),t=Math.max(n.cellHeight*p.entities.length,i.mainCanvasBox.clientHeight);i.canvasColumn.style.width=`${e+r.scrollWidth}px`,i.sideCanvas.style.width=`${e+r.scrollWidth}px`,i.mainCanvas.style.width=`${e}px`,i.mainCanvas.style.height=`${t}px`}function V(){i.canvasTitle.replaceChildren(),r.renderCanvasTitle(i.canvasTitle,r.canvasTitle)}let z=new Map;function de(){i.canvasColumn.replaceChildren(),z.clear();let e=0,t=n.chartRenderStartTime;for(;e<n.canvasColumnCount;){const o=document.createElement("div");o.classList.add(mn);const m=e==0?0:e*n.cellWidth+1;o.style.left=`${m}px`,o.style.width=`${n.cellWidth}px`,r.renderHeaderCell(t,o),i.canvasColumn.appendChild(o),z.set(e,o),t=new Date(t.getTime()+A(r.cellMinutes)),e++}re()}function re(){n.canvasColumnVLines.length=0;let e=0;for(let t=0;t<n.canvasColumnCount;t++){e+=n.cellWidth;const o=document.createElement("div");o.classList.add(gt),o.style.left=`${e}px`,i.canvasColumn.appendChild(o),n.canvasColumnVLines.push(o)}}function me(){let e=0;for(let t=0;t<n.canvasColumnVLines.length;t++){e+=n.cellWidth;const o=n.canvasColumnVLines[t];o.style.left=`${e}px`}}function s(){for(const[e,t]of z){const o=e==0?0:e*n.cellWidth+1;t.style.left=`${o}px`,t.style.width=`${n.cellWidth}px`}me()}function l(e,t){var o,m;if(t.ctrlKey){let d={x:0,y:0};if(t.target==e)d.x=t.offsetX,d.y=t.offsetY;else if(t.target.parentElement==e)d.x=t.target.offsetLeft+t.offsetX,d.y=t.target.offsetTop+t.offsetY;else if(((m=(o=t.target)==null?void 0:o.parentElement)==null?void 0:m.parentElement)==e)d.x=t.target.parentElement.offsetLeft+t.offsetX,d.y=t.target.parentElement.offsetTop+t.offsetY;else return;t.deltaY>0?Xe(d.x,d.y):Ue(d.x,d.y)}}function a(){i.sideCanvas.replaceChildren(),r.hasVerticalLine&&u(),r.useGroupEvent?an():N()}function u(){n.sideCanvasVLines.length=0;const e=i.sideCanvas.scrollWidth,t=Math.ceil(e/n.cellWidth);let o=0;for(let m=0;m<t;m++){o+=n.cellWidth;const d=document.createElement("div");d.classList.add(gt),d.style.left=`${o}px`,i.sideCanvas.appendChild(d),n.sideCanvasVLines.push(d)}}function E(){M(),r.useGroupEvent?rn():I()}function M(){let e=0;for(let t=0;t<n.sideCanvasVLines.length;t++){e+=n.cellWidth;const o=n.sideCanvasVLines[t];o.style.left=`${e}px`}}function N(){let e=p.sidePointEvents;r.maxRenderCountPerRow<p.sidePointEvents.length&&(e=$e(p.sidePointEvents,r.maxRenderCountPerRow),console.warn(`The number of side point events exceeds the maximum limit. [max: ${r.maxRenderCountPerRow}, current: ${p.sidePointEvents.length}]`)),n.sidePointEventItems.length=0;for(const t of e)H(t)}function H(e){const t=e.time;if(!te(t))return;const o=document.createElement("div"),{top:m,left:d}=P(t);o.style.top=`${m}px`,o.style.left=`${d}px`,o.classList.add(gn),r.renderSidePointEvent(e,i.sideCanvas,o),i.sideCanvas.appendChild(o),n.sidePointEventItems.push({time:t,containerEl:o})}function I(){for(const e of n.sidePointEventItems){const t=e.time,o=e.containerEl,{top:m,left:d}=P(t);o.style.top=`${m}px`,o.style.left=`${d}px`}}function P(e){const[t]=ce(e),m=K(t.valueOf()-n.chartRenderStartTime.valueOf())*n.cellWidth/r.cellMinutes,d=(r.sideCanvasHeight-he())/2,g=he();return{left:m-g/2,top:d}}function S(){i.mainCanvas.replaceChildren(),r.hasVerticalLine&&Re(),tn()}function b(){be(),nn()}function ye(){for(const[e,t]of n.activeEntityRows.entries())ze(t)}function Re(){n.mainCanvasVLines.length=0;const e=i.mainCanvas.scrollWidth,t=n.cellWidth,o=i.mainCanvas.scrollHeight,m=Math.ceil(e/t);let d=0;for(let g=1;g<=m-1;g++){d+=t;const w=document.createElement("div");w.classList.add(Tn),w.style.left=`${d}px`,w.style.height=`${o}px`,i.mainCanvas.appendChild(w),n.mainCanvasVLines.push(w)}}function be(){for(let e=0;e<n.mainCanvasVLines.length;e++){const t=n.mainCanvasVLines[e];t.style.left=`${(e+1)*n.cellWidth}px`}}function X(){n.entityContainerRows.clear(),n.activeEntityRows.clear(),i.gridBox.replaceChildren(),r.renderMode=="scroll"?kt():r.renderMode=="intersection"?Vt():Yt()}function Ve(e){const{index:t,entity:o,containerEl:m}=e;if(r.renderGridRow(t,o,m),Ft(o,e),r.hasHorizontalLine){const d=document.createElement("div");d.classList.add(En),d.style.top=`${n.cellHeight*t}px`,i.mainCanvas.appendChild(d),e.hLine=d}e.lastRenderTime=new Date}function ze(e){const{index:t}=e;e.hLine.style.top=`${n.cellHeight*t}px`,Wt(e),e.lastRenderTime=new Date}function Wt(e){Jt(e),qt(e)}function Gt(e,t){const o=document.createElement("div");return o.classList.add(Cn),o.addEventListener("mouseenter",m=>{o.tag=o.style.backgroundColor,o.style.backgroundColor=r.rowHoverColor}),o.addEventListener("mouseleave",m=>{o.style.backgroundColor=o.tag}),o.addEventListener("click",m=>{const g=n.entityContainerRows.get(o).entity,w=Ut(g);if(w!=null){const[k]=ce(w),F=K(k.valueOf()-n.chartRenderStartTime.valueOf())*n.cellWidth/r.cellMinutes;i.mainCanvasBox.scrollLeft=F+r.entityEventSearchScrollOffset}}),o.tag=e,o}function ke(e,t){const o=Gt(e,p.entities[e]);i.gridBox.appendChild(o);const m={index:e,containerEl:o,entity:p.entities[e],pointEventContainers:[],rangeEventContainers:[]};return n.entityContainerRows.set(o,m),o}function Vt(){x==null||x.disconnect();const e={root:i.gridBox,threshold:0};x=new IntersectionObserver(zt,e);const t=p.entities.length;for(let o=0;o<t;o++){const m=ke(o,p.entities[o]);x.observe(m)}}const zt=e=>{e.forEach((t,o)=>{var g,w;const m=t.target,d=n.entityContainerRows.get(m);t.isIntersecting?(d.lastRenderTime==null?Ve(d):d.lastRenderTime<=n.lastZoomTime&&ze(d),n.activeEntityRows.set(d.index,d)):((g=t.rootBounds)==null?void 0:g.width)===0&&((w=t.rootBounds)==null?void 0:w.height)===0||n.activeEntityRows.delete(d.index)})};function kt(){i.mainCanvasBox.removeEventListener("scroll",Ye),i.mainCanvasBox.addEventListener("scroll",Ye);const e=p.entities.length;for(let t=0;t<e;t++)ke(t,p.entities[t]);Ye()}function Ye(){const e=i.mainCanvasBox.scrollTop,t=i.mainCanvasBox.clientHeight,o=e+t;for(const[m,d]of n.entityContainerRows.entries()){const g=d.index*n.cellHeight,w=g+n.cellHeight;g<=o&&e<=w?(d.lastRenderTime==null?Ve(d):d.lastRenderTime<n.lastZoomTime&&ze(d),n.activeEntityRows.set(d.index,d)):n.activeEntityRows.delete(d.index)}}function Yt(){const e=p.entities.length;for(let t=0;t<e;t++){const o=ke(t,p.entities[t]),m=n.entityContainerRows.get(o);Ve(m),n.activeEntityRows.set(t,m)}}function Ut(e){const t=Xt(e.rangeEvents);let o=null;0<t.length&&(o=t[0].startTime);const m=Zt(e.pointEvents);let d=null;0<m.length&&(d=m[0].time);let g=null;return o!=null&&d!=null?g=o<d?o:d:o!=null&&d==null?g=o:o==null&&d!=null&&(g=d),g}function Xt(e){return e==null||e.length==0?[]:e.filter(t=>n.chartRenderStartTime.valueOf()<=t.endTime.valueOf()&&t.startTime.valueOf()<=n.chartRenderEndTime.valueOf()).sort((t,o)=>t.startTime.valueOf()-o.startTime.valueOf())}function Zt(e){return e==null||e.length==0?[]:e.filter(t=>n.chartRenderStartTime.valueOf()<=t.time.valueOf()&&t.time.valueOf()<=n.chartRenderEndTime.valueOf()).sort((t,o)=>t.time.valueOf()-o.time.valueOf())}function Ft(e,t){jt(e,t),Kt(e,t)}function jt(e,t){let o=e.pointEvents;r.maxRenderCountPerRow<e.pointEvents.length&&(o=$e(e.pointEvents,r.maxRenderCountPerRow),console.warn(`The number of entity point events exceeds the maximum limit. [max: ${r.maxRenderCountPerRow}, current: ${e.pointEvents.length}]`));for(const m of o)Qt(m,t)}function Kt(e,t){let o=e.rangeEvents;r.maxRenderCountPerRow<e.rangeEvents.length&&(o=$e(e.rangeEvents,r.maxRenderCountPerRow),console.warn(`The number of entity range events exceeds the maximum limit. [max: ${r.maxRenderCountPerRow}, current: ${e.rangeEvents.length}]`));for(const m of o)en(m,t)}function Jt(e){for(const t of e.pointEventContainers){const o=t.time,m=e.index,d=t.containerEl,{top:g,left:w}=tt(o,m);d.style.top=`${g}px`,d.style.left=`${w}px`}}function Qt(e,t){const o=e.time,m=t.index;if(!te(o))return;const d=document.createElement("div"),{top:g,left:w}=tt(o,m);d.style.top=`${g}px`,d.style.left=`${w}px`,d.classList.add(Ln),r.renderEntityPointEvent(e,i.mainCanvas,d),i.mainCanvas.appendChild(d),t.pointEventContainers.push({time:o,containerEl:d})}function tt(e,t){const[o]=ce(e),d=K(o.valueOf()-n.chartRenderStartTime.valueOf())*n.cellWidth/r.cellMinutes,g=ve(),w=n.cellHeight*t+(n.cellHeight-g)/2-1;return{left:d-g/2,top:w}}function qt(e){for(const t of e.rangeEventContainers){const o=t.startTime,m=t.endTime,d=e.index,{left:g,width:w}=Ne(o,m,d);t.containerEl.style.left=`${g}px`,t.containerEl.style.width=`${w}px`}}function Ne(e,t,o){const[m,d]=ce(e,t),g=K(m.valueOf()-n.chartRenderStartTime.valueOf()),w=K(d.valueOf()-m.valueOf()),k=g*n.cellWidth/r.cellMinutes,Z=w*n.cellWidth/r.cellMinutes,F=n.cellHeight*o+(n.cellHeight-_e())/2-1;return{left:k,top:F,width:Z}}function en(e,t){const o=e.startTime,m=e.endTime,d=t.index;if(!te(o,m))return;const g=document.createElement("div"),{top:w,left:k,width:Z}=Ne(o,m,d);g.style.left=`${k}px`,g.style.top=`${w}px`,g.style.width=`${Z}px`,g.classList.add(_n),r.renderEntityRangeEvent(e,i.mainCanvas,g),i.mainCanvas.appendChild(g),t.rangeEventContainers.push({startTime:o,endTime:m,containerEl:g})}function $e(e,t){if(e.length<=t)return e;const o=[],m=e.length/t;for(let d=0;d<e.length;d+=m){const g=Math.floor(d);o.push(e[g])}return o}function tn(){let e=p.globalRangeEvents;r.maxRenderCountPerRow<p.globalRangeEvents.length&&(e=$e(p.globalRangeEvents,r.maxRenderCountPerRow),console.warn(`The number of global range events exceeds the maximum limit. [max: ${r.maxRenderCountPerRow}, current: ${p.globalRangeEvents.length}]`));for(const t of e)on(t)}function nn(){for(const e of n.globalRangeEventItems){const t=e.startTime,o=e.endTime,{left:m,width:d}=Ne(t,o,0);e.containerEl.style.left=`${m}px`,e.containerEl.style.width=`${d}px`}}function on(e){const t=e.startTime,o=e.endTime;if(!te(t,o))return;const{left:m,width:d}=Ne(t,o,0),g=document.createElement("div");g.style.left=`${m}px`,g.style.width=`${d}px`,g.classList.add(xn),r.renderGlobalRangeEvent(e,i.mainCanvas,g),i.mainCanvas.appendChild(g),n.globalRangeEventItems.push({startTime:t,endTime:o,containerEl:g})}function Ue(e,t){const o=r.zoomScale*(1+r.zoomChangeRate);Ze(o,e,t)}function Xe(e,t){const o=r.zoomScale/(1+r.zoomChangeRate);Ze(o,e,t)}function Ze(e,t,o){if(e<=r.minZoomScale&&(e=r.minZoomScale),r.maxZoomScale<=e&&(e=r.maxZoomScale),e===r.zoomScale)return;r.zoomScale=e;let m=i.mainCanvasBox.scrollLeft,d=i.mainCanvasBox.scrollTop;if(r.hZoomEnabled){const g=n.originalCellWidth*e,w=n.cellWidth;if(n.cellWidth=g,t){const k=t-m;m=t*g/w-k}}if(r.vZoomEnabled){const g=n.cellHeight,w=n.originalCellHeight*e;if(U(w),o){const k=o-d;d=o*w/g-k}}n.lastZoomTime=new Date,ot(),nt(m,d)}function nt(e,t){i.mainCanvasBox.scrollLeft=e,i.mainCanvasBox.scrollTop=t}function ot(){W(),s(),E(),b(),ye()}function sn(){return n.cellWidth/r.cellMinutes}function it(){const e=[],t=r.groupEventWidth,o=sn(),m=t/o;let d=n.chartRenderStartTime;for(;d<=n.chartRenderEndTime;)e.push({startTime:d,endTime:new Date(d.valueOf()+A(m)),events:[]}),d=new Date(d.valueOf()+A(m));for(const g of e){const w=p.sidePointEvents.filter(k=>g.startTime<=k.time&&k.time<g.endTime);g.events=w}return e}function rn(){Fe=it(),De()}function De(){const e=i.mainCanvasBox.scrollLeft,t=e+i.mainCanvasBox.clientWidth,o=Math.ceil(i.mainCanvas.scrollWidth/r.groupEventWidth);for(let m=0;m<o;m++){const d=Fe[m],g=m*r.groupEventWidth,w=g+r.groupEventWidth;if(e<w&&g<t){if(je.has(m)){const Ke=je.get(m);r.renderGroupEvent(d,i.sideCanvas,Ke);continue}const Z={width:r.groupEventWidth,height:30,x:g,y:5},F=document.createElement("div");F.style.width=`${Z.width}px`,F.style.height=`${Z.height}px`,F.style.position="absolute",F.style.left=`${Z.x}px`,F.style.top=`${Z.y}px`,r.renderGroupEvent(d,i.sideCanvas,F),i.sideCanvas.appendChild(F),je.set(m,F)}}}let Fe=[];const je=new Map;function an(){Fe=it(),i.mainCanvasBox.removeEventListener("scroll",De),i.mainCanvasBox.addEventListener("scroll",De),De()}return{create:j,setOptions:xe,getOptions:ge,setData:G,getData:R,setChartTimeRange:ue,render:T,renderCanvas:h}};var ee=(c=>(c.ASC="asc",c.DESC="desc",c.NONE="none",c))(ee||{});const Yn="pl-root-container",Un="pl-legend-container",Xn="pl-chart-container",Zn="pl-legends",Ot="pl-legends-left",Rt="pl-legends-right",Fn="pl-legend",jn="pl-legend-icon",Kn="pl-legend-label",Jn="pl-grid-title",Qn="pl-grid-columns",qn="pl-grid-column",eo="pl-grid-column-caption",to="pl-grid-column-icon",no="pl-grid-row",oo="pl-grid-cell",qe="pl-tooltip",bt="pl-tooltip-close",Nt="pl-tooltip-title",$t="pl-tooltip-visible",Dt="pl-tooltip-invisible",io="pl-canvas-title",so="pl-canvas-column",et="pl-entity-point-event",ro="pl-entity-range-event",ao="pl-global-range-event";function Ht(){const c={coreOptions:{renderMode:"scroll",gridTitle:"",canvasTitle:"",chartStartTime:new Date,chartEndTime:new Date,leftPanelWidth:350,columnTitleHeight:50,columnHeaderHeight:50,sideCanvasHeight:50,sideCanvasContentHeightRatio:.8,cellMinutes:20,cellWidth:100,cellHeight:50,mainRangeContentRatio:.9,mainPointContentRatio:.8,minZoomScale:1,maxZoomScale:10,zoomScale:1,hasHorizontalLine:!0,hasVerticalLine:!0,columnAutoWidth:!0,rowHoverColor:"#ddd",borderColor:"#333c77",canvasLineColor:"#e1edf8",fixedController:!0,controllerLocation:"bottomRight",renderGridRow:_,renderHeaderCell:D,renderGridTitle:ue,renderGridColumns:G,renderCanvasTitle:C,customizeElements:v,renderSidePointEvent:xe,renderGlobalRangeEvent:ge,renderEntityPointEvent:le,renderEntityRangeEvent:se,useGroupEvent:!1,groupEventWidth:50,renderGroupEvent:$},useGroupEvent:!1,useEventHoverColor:!0,eventHoverColor:"#ccc",gridColumns:[],formatTime:s=>Je(s).format("YYYY-MM-DD HH:mm:ss"),formatTimeRange:x,renderCanvasColumn:D,renderPointEventTooltip:Le,renderRangeEventTooltip:ve,renderEventTooltip:(s,l,a)=>{y(s,l,a)},getEventColor:s=>"",hasTooltipLazyLoading:s=>!1,hasTooltipShowTime:s=>!0,getEventIconSrc:s=>"",getEventClassName:s=>"",getTooltipTitle:s=>"",getTooltipTextLines:s=>[],getTooltipLazyTextLines:s=>Promise.resolve([]),hasTooltipVisible:s=>!0},p={legends:[],entities:[],sidePointEvents:[],globalRangeEvents:[]},r=document.createElement("div"),n={entitiesBackup:[],gridColumnMap:new Map,gridColumnIconMap:new Map,gridColumnSortFuncs:[],sortDirection:ee.NONE,sortColumnField:"",containerEl:r,legendsEl:r,fixedTooltips:new Set,elementCustomized:!1},f=kn();function i(s){n.containerEl=s,n.legendsEl=T();const l=document.createElement("div");l.classList.add(Yn);const a=document.createElement("div");a.classList.add(Un),a.appendChild(n.legendsEl),l.appendChild(a);const u=document.createElement("div");u.classList.add(Xn),f.create(u),f.setOptions(c.coreOptions),l.appendChild(u),n.containerEl.appendChild(l)}function x(s,l){const u=(l.getTime()-s.getTime())/1e3,E=u/60,M=E/60,N=M/24,H=N/30,I=H/12,P=Math.floor(u%60),S=Math.floor(E%60),b=Math.floor(M%24),ye=Math.floor(N%30),Re=Math.floor(H%12),be=Math.floor(I);let X="";return be>0&&(X=X+be+"년"),Re>0&&(X=X+Re+"개월"),ye>0&&(X=X+ye+"일"),b>0&&(X=X+b+"시간"),S>0&&(X=X+S+"분"),P>0&&(X=X+P+"초"),X===""&&(X="0초"),X}function D(s,l){const a=document.createElement("div");return a.classList.add(so),a.innerText=Je(s).format("HH:mm"),l.appendChild(a),a}function O(s){const l=s.style.backgroundColor;s.addEventListener("mouseenter",a=>{s.style.backgroundColor=c.eventHoverColor}),s.addEventListener("mouseleave",a=>{s.style.backgroundColor=l})}function j(s){s.classList.add($t),s.classList.remove(Dt)}function oe(s){s.classList.add(Dt),s.classList.remove($t)}function U(s){j(s),n.fixedTooltips.add(s)}function K(s){oe(s),n.fixedTooltips.delete(s)}function A(s,l){const a=l??s.tag;if(!a)return;s.tag=l;const u=10,M=s.getBoundingClientRect().height,N=window.innerHeight-u*2;M>=N?s.style.maxHeight=N+"px":s.style.maxHeight="";let H=a.clientX,I=a.clientY,P=H+u,S=I+u;H+u+s.offsetWidth>window.innerWidth&&(P=Math.max(u,H-s.offsetWidth-u)),window.innerHeight<I+s.offsetHeight+u&&(S=Math.max(u,window.innerHeight-s.offsetHeight-u)),s.style.top=S+"px",s.style.left=P+"px"}function J(s){return n.fixedTooltips.has(s)}function ie(s,l,a="dblclick"){s.addEventListener("mousemove",u=>{u.target===s&&(J(l)||A(l,u))}),s.addEventListener("mouseleave",u=>{J(l)||oe(l)}),s.addEventListener("mouseenter",u=>{J(l)||(j(l),A(l,u))}),s.addEventListener(a,u=>{u.stopPropagation(),J(l)?K(l):U(l)}),s.addEventListener("click",u=>{u.stopPropagation()}),l.addEventListener("click",u=>{u.stopPropagation()}),l.addEventListener("mousemove",u=>{u.stopPropagation()})}function fe(s,l){const a=document.createElement("div");return a.innerText=s,l.appendChild(a),a}function Le(s,l,a){const u=document.createElement("img");u.classList.add(bt),u.src=rt,u.addEventListener("click",P=>{K(a)}),a.appendChild(u);const E=document.createElement("div");E.classList.add(Nt);const M=c.getTooltipTitle(s);if(E.innerText=M,a.appendChild(E),c.hasTooltipShowTime(s)){const P=document.createElement("div");P.innerText=c.formatTime(s.time),a.appendChild(P)}const H=c.getTooltipTextLines(s);for(const P of H)fe(P,a);if(c.hasTooltipLazyLoading(s)){let P=!1;l.addEventListener("mouseenter",async S=>{if(P)return;P=!0;const b=await c.getTooltipLazyTextLines(s);for(const ye of b)fe(ye,a);A(a)})}}async function _e(s,l,a,u){const E=document.createElement("img");E.classList.add(u.img),E.src=c.getEventIconSrc(s);const M=c.getEventClassName(s);if(M&&E.classList.add(M),a.appendChild(E),c.hasTooltipVisible(s)){const H=document.createElement("div");H.classList.add(qe),l.appendChild(H),c.renderPointEventTooltip(s,E,H),ie(E,H)}c.useEventHoverColor&&O(E)}function ve(s,l,a){const u=document.createElement("img");u.classList.add(bt),u.src=rt,u.addEventListener("click",I=>{K(a)}),a.appendChild(u);const E=document.createElement("div");if(E.classList.add(Nt),E.innerText=c.getTooltipTitle(s),a.appendChild(E),c.hasTooltipShowTime(s)){const I=c.formatTime(s.startTime),P=c.formatTime(s.endTime),S=c.formatTimeRange(s.startTime,s.endTime),b=document.createElement("div");b.innerText=`${I} ~ ${P} (${S})`,a.appendChild(b)}const N=c.getTooltipTextLines(s);for(const I of N)fe(I,a);if(c.hasTooltipLazyLoading(s)){let I=!1;l.addEventListener("mouseenter",async P=>{if(I)return;I=!0;const S=await c.getTooltipLazyTextLines(s);for(const b of S)fe(b,a);A(a)})}}async function he(s,l,a,u){const E=document.createElement("div");E.classList.add(u.box);const M=c.getEventClassName(s);M&&E.classList.add(M);const N=c.getEventColor(s);if(N&&(E.style.backgroundColor=N),a.appendChild(E),c.hasTooltipVisible(s)){const I=document.createElement("div");I.classList.add(qe),l.appendChild(I),c.renderRangeEventTooltip(s,E,I),ie(E,I)}c.useEventHoverColor&&O(E)}async function le(s,l,a){_e(s,l,a,{img:et})}async function se(s,l,a){he(s,l,a,{box:ro})}function xe(s,l,a){le(s,l,a)}async function ge(s,l,a){he(s,l,a,{box:ao})}function ue(s,l){const a=document.createElement("div");a.classList.add(Jn),a.innerText=l,s.appendChild(a)}function G(s){const l=document.createElement("div");l.classList.add(Qn),s.appendChild(l);let a=0;for(const u of n.gridColumnMap.keys()){const[E,M]=R(l,a++,u.caption);l.appendChild(E),n.gridColumnMap.set(u,E),n.gridColumnIconMap.set(u,M)}for(const[u,E]of n.gridColumnMap.entries())E.addEventListener("click",M=>{const N=u.field;n.sortColumnField!=N?n.sortDirection=ee.ASC:n.sortDirection==ee.ASC?n.sortDirection=ee.DESC:n.sortDirection==ee.DESC?n.sortDirection=ee.NONE:n.sortDirection=ee.ASC,n.sortColumnField=N;for(const P of n.gridColumnIconMap.values())te(P,ee.NONE);const H=n.gridColumnIconMap.get(u);te(H,n.sortDirection),ce(N,n.sortDirection);const I=new CustomEvent("sort",{detail:{field:N,direction:n.sortDirection}});window.dispatchEvent(I)})}function R(s,l,a){const u=document.createElement("div");u.classList.add(qn),u.setAttribute("data-index",l.toString());const E=document.createElement("div");E.classList.add(eo),E.innerText=a,u.appendChild(E);const M=document.createElement("div");return M.classList.add(to),u.appendChild(M),s.appendChild(u),[u,M]}function te(s,l){l==ee.ASC?s.innerHTML="&#9650;":l==ee.DESC?s.innerHTML="&#9660;":s.innerHTML=""}function ce(s,l){let a=[...n.entitiesBackup];if(l==ee.NONE){f.setData({entities:a,sidePointEvents:p.sidePointEvents,globalRangeEvents:p.globalRangeEvents}),f.renderCanvas();return}const u=n.gridColumnSortFuncs.find(E=>E.field==s);u&&(a=p.entities.sort(u.compareFn)),f.setData({entities:a,sidePointEvents:p.sidePointEvents,globalRangeEvents:p.globalRangeEvents}),f.setData({entities:a,sidePointEvents:p.sidePointEvents,globalRangeEvents:p.globalRangeEvents}),f.renderCanvas()}function _(s,l,a){a.classList.add(no),l.gridRowClassName&&a.classList.add(l.gridRowClassName);let u=0;for(const E of n.gridColumnMap.keys()){const M=document.createElement("div");M.setAttribute("data-index",(u++).toString()),M.classList.add(oo),M.innerText=l[E.field].toString()??"",a.appendChild(M)}}function C(s,l){const a=document.createElement("div");a.classList.add(io),a.innerText=l,s.appendChild(a)}function v(s){n.elementCustomized||(n.elementCustomized=!0,s.rootElement.addEventListener("click",l=>{for(const a of n.fixedTooltips.values())K(a)}))}function T(){const s=document.createElement("div");s.classList.add(Zn);const l=document.createElement("div");l.classList.add(Ot);const a=document.createElement("div");return a.classList.add(Rt),s.appendChild(l),s.appendChild(a),s}function h(){if(!p.legends)return;const s=n.legendsEl.getElementsByClassName(Ot)[0],l=n.legendsEl.getElementsByClassName(Rt)[0];s.replaceChildren(),l.replaceChildren();for(const a of p.legends){const u=document.createElement("div");u.classList.add(Fn),a.location=="left"||a.location==null?s.appendChild(u):l.appendChild(u);const E=document.createElement("div");E.classList.add(jn),a.icon&&(E.style.backgroundImage=`url(${a.icon})`,E.style.backgroundSize="contain"),a.color&&(E.style.backgroundColor=a.color),a.className&&E.classList.add(a.className);const M=document.createElement("div");M.classList.add(Kn),M.innerText=a.label,u.appendChild(E),u.appendChild(M)}}function y(s,l,a){let u=1;for(const E of s.events){const M=document.createElement("div");M.style.whiteSpace="pre";const H=`[${E.type}]`.padEnd(12," "),I=Je(E.time).format("YYYY-MM-DD HH:mm:ss");M.innerText=`${u}. ${H} ${I}`,a.appendChild(M),u++}}const L=new Map;function $(s,l,a){if(!(0<s.events.length)){let S=a.children[0];const b=L.get(S);return b&&b.remove(),a.replaceChildren(),a}let E=a.children[0];const M=L.get(E);M&&M.remove(),a.replaceChildren();const N=document.createElement("div");N.style.position="relative",N.style.width="100%",N.style.height="100%";const H=s.events.reduce((S,b)=>(S.push(b.type),S),[]),I=1<H.length?un:c.getEventIconSrc(s.events[0]);if(1<H.length){const S=document.createElement("img");S.style.position="absolute",S.src=I,S.style.width="30px",S.style.height="30px",S.classList.add(et),N.appendChild(S);const b=document.createElement("div");b.style.position="absolute",b.style.left="50%",b.style.top="50%",b.style.color="white",b.innerText=s.events.length.toString(),N.appendChild(b),a.appendChild(N),c.useEventHoverColor&&O(S)}else{const S=document.createElement("img");S.src=I,S.style.width="30px",S.style.height="30px",S.classList.add(et),N.appendChild(S),a.appendChild(N),c.useEventHoverColor&&O(S)}if(c.hasTooltipVisible(s)){let S=a.children[0];if(L.has(S)){const b=L.get(S);b.replaceChildren(),c.renderEventTooltip(s,S,b)}else{const b=document.createElement("div");b.classList.add(qe),c.renderEventTooltip(s,S,b),l.appendChild(b),ie(S,b),L.set(S,b)}}return a}function B(s){var l,a;Object.assign(c,s),s.coreOptions&&(s.useGroupEvent&&(s.coreOptions.useGroupEvent=s.useGroupEvent),f.setOptions(s.coreOptions)),n.gridColumnMap.clear(),(l=c.gridColumns)==null||l.forEach(u=>{n.gridColumnMap.set(u,r)}),n.gridColumnSortFuncs=((a=c.gridColumns)==null?void 0:a.map(u=>({field:u.field,compareFn:(E,M)=>{var P,S;const N=(P=E[u.field])==null?void 0:P.toString(),H=(S=M[u.field])==null?void 0:S.toString();return(n.sortDirection==ee.ASC?1:-1)*N.localeCompare(H)}})))??[]}function W(){const s=f.getOptions(),l={...c};return Object.assign(l,s),l}function V(s){Object.assign(p,s),n.entitiesBackup=p.entities.map(l=>({...l,pointEvents:[...l.pointEvents],rangeEvents:[...l.rangeEvents]})),f.setData({entities:p.entities,sidePointEvents:p.sidePointEvents,globalRangeEvents:p.globalRangeEvents})}function z(){return p}function de(){n.elementCustomized=!1,h(),f.render()}function re(){ce(n.sortColumnField,n.sortDirection)}function me(){return f}return{create:i,setOptions:B,getOptions:W,setData:V,getData:z,render:de,renderCanvas:re,getCoreChart:me}}const we="/PlumChart/assets/error-73acc930.svg",Te="/PlumChart/assets/warning-04038b37.svg";var Se=(c=>(c.Quality="quality",c.Safety="safety",c))(Se||{}),pe=(c=>(c.Op1="op1",c.Op2="op2",c.Op3="op3",c.Op4="op4",c.NetworkError="networkError",c))(pe||{}),ne=(c=>(c.Man="man",c.Delivery="delivery",c.Cost="cost",c))(ne||{}),q=(c=>(c.Downtime="downtime",c.Network="network",c))(q||{});const Pe=Object.values(Se),Be=Object.values(pe),Ae=Object.values(ne),lo=Object.values(q),Oe=new Map([[pe.Op1,"pl-op1"],[pe.Op2,"pl-op2"],[pe.Op3,"pl-op3"],[pe.Op4,"pl-op4"],[pe.NetworkError,"pl-network"]]),co=Be.map(c=>({label:c,className:Oe.get(c)})),uo=Pe.map(c=>({label:c,icon:Te})),mo=Ae.map(c=>({label:c,icon:we,location:"right"})),fo=lo.map(c=>({label:c,className:c===q.Downtime?"pl-downtime":"pl-network",location:"right"})),Pt=[...co,...uo,...mo,...fo];new Date(2024,0,1,2,0,0,0),ne.Cost,new Date(2024,0,1,2,10,0,0),ne.Delivery,new Date(2024,0,1,2,20,0,0),ne.Man,new Date(2024,0,1,3,0,0,0),ne.Cost,new Date(2024,0,1,3,10,0,0),ne.Delivery,new Date(2024,0,1,3,20,0,0),ne.Man;const Bt=[{startTime:new Date(2024,0,1,1,10,0,0),endTime:new Date(2024,0,1,2,30,0,0),type:q.Downtime},{startTime:new Date(2024,0,1,2,50,0,0),endTime:new Date(2024,0,1,3,20,0,0),type:q.Network},{startTime:new Date(2024,0,1,3,40,0,0),endTime:new Date(2024,0,1,4,0,0,0),type:q.Network},{startTime:new Date(2024,0,1,6,10,0,0),endTime:new Date(2024,0,1,6,30,0,0),type:q.Downtime},{startTime:new Date(2024,0,1,7,0,0,0),endTime:new Date(2024,0,1,8,20,0,0),type:q.Network},{startTime:new Date(2024,0,1,10,0,0,0),endTime:new Date(2024,0,1,12,0,0,0),type:q.Downtime},{startTime:new Date(2024,0,1,14,0,0,0),endTime:new Date(2024,0,1,16,20,0,0),type:q.Network}],We=(c,p)=>Math.floor(Math.random()*(p-c+1)+c),Ge=[],vo=0;for(let c=0;c<vo;c++)Ge.push({number:`Net-${0+c}`,product:"Network Error",operations:[{startTime:new Date(2023,11,29,0,0,0,0),endTime:new Date(2024,0,1,c+3,0,0,0),type:pe.NetworkError}],errors:[]});let He=60;for(let c=0;c<100;c++){let p=He,r=He;const n={number:`20240101000${c}`,product:`P12${c%10}`,operations:Array.from({length:5}).map((f,i)=>{const x=p,D=We(p+1,p+2),O=We(0,1);return p=D+O,{startTime:new Date(2024,0,1,Math.floor(x/60),x%60,0,0),endTime:new Date(2024,0,1,Math.floor(D/60),D%60,0,0),type:Be[Math.floor(Math.random()*Be.length)%Be.length]}}),errors:Array.from({length:3}).map((f,i)=>(r=We(r,r+10),{time:new Date(2024,0,1,Math.floor(He/60),r%60,0,0),type:Pe[Math.floor(Math.random()*Pe.length)%Pe.length]}))};n.errors.forEach(f=>f.lot=n),n.operations.forEach(f=>f.lot=n),Ge.push(n),He=p+5}function At(c,p=1200){const r=[];let n=0;for(let f=0;f<c;f++){n=We(n,n+p);let i=Math.floor(n/86400),x=Math.floor(n/3600)%24,D=Math.floor(n/60)%60,O=n%60;r.push({time:new Date(2024,0,1+i,x,D,O,0),type:Ae[Math.floor(Math.random()*Ae.length)%Ae.length]})}return r}function ho(c){const p=Ht();p.create(c);const r={coreOptions:{gridTitle:"Lot Information",canvasTitle:"Lot Status",chartStartTime:new Date(2024,0,1,0,0,0,0),chartEndTime:new Date(2024,0,1,24,0,0,0),columnAutoWidth:!0,cellWidth:50,cellMinutes:60,maxZoomScale:30,minZoomScale:1,zoomScale:3,zoomChangeRate:.2},useGroupEvent:!0,useEventHoverColor:!1,eventHoverColor:"#ccc",gridColumns:[{field:"number",caption:"Lot Number"},{field:"product",caption:"Product"}],hasTooltipVisible:n=>!0,hasTooltipShowTime:n=>!0,getEventIconSrc:n=>{const f=n.type;return f===Se.Quality?we:f===Se.Safety?Te:f===ne.Man?we:(f===ne.Cost,Te)},getTooltipTitle:n=>n.type,getTooltipTextLines:n=>{const f=n.lot;return f?["Lot Number: "+f.number,"Product: "+f.product]:[]},hasTooltipLazyLoading:n=>!0,getTooltipLazyTextLines:n=>new Promise((f,i)=>{setTimeout(()=>{f(["Lazy: "+new Date])},500)}),getEventClassName:n=>{const f=n.type;return f===q.Downtime?"pl-downtime":f===q.Network?"pl-network":Oe.has(f)?Oe.get(f):""}};p.setOptions(r),p.setData({legends:Pt,entities:Ge.filter((n,f)=>f<100).map(n=>({number:n.number,product:n.product,pointEvents:n.errors,rangeEvents:n.operations})),sidePointEvents:At(200,1e3),globalRangeEvents:Bt}),p.render()}function Co(c){const p=Ht();p.create(c);const r={useEventHoverColor:!1,eventHoverColor:"#ccc",gridColumns:[{field:"number",caption:"Lot Number"},{field:"product",caption:"Product"}],coreOptions:{gridTitle:"Lot Information",canvasTitle:"Lot Status",chartStartTime:new Date(2024,0,1,0,0,0,0),chartEndTime:new Date(2024,0,1,3,0,0,0),columnAutoWidth:!0,cellWidth:200,maxZoomScale:10,minZoomScale:1,zoomScale:2,scrollLeft:1e5},hasTooltipVisible:i=>!0,hasTooltipShowTime:i=>!0,getEventIconSrc:i=>{const x=i.type;return x===Se.Quality?we:x===Se.Safety?Te:x===ne.Man?we:(x===ne.Cost,Te)},getTooltipTitle:i=>i.type,getTooltipTextLines:i=>{const x=i.lot;return x?["Lot Number: "+x.number,"Product: "+x.product]:[]},hasTooltipLazyLoading:i=>!0,getTooltipLazyTextLines:i=>new Promise((x,D)=>{setTimeout(()=>{x(["Lazy: "+new Date])},500)}),getEventClassName:i=>{const x=i.type;return x===q.Downtime?"pl-downtime":x===q.Network?"pl-network":Oe.has(x)?Oe.get(x):""}},n={legends:Pt,entities:Ge.map(i=>({number:i.number,product:i.product,pointEvents:i.errors,rangeEvents:i.operations})),sidePointEvents:At(600,2400),globalRangeEvents:Bt},f={entities:n.entities.filter((i,x)=>i.rangeEvents.some(O=>r.coreOptions.chartStartTime.getTime()<O.endTime.getTime()&&O.startTime.getTime()<r.coreOptions.chartEndTime.getTime()))};p.setOptions(r),p.setData(n),p.setData(f),p.render(),setInterval(()=>{const i=p.getOptions(),x=i.coreOptions.chartStartTime;x.setMinutes(x.getMinutes()+1);const D=i.coreOptions.chartEndTime;D.setMinutes(D.getMinutes()+1);const O={coreOptions:{chartStartTime:x,chartEndTime:D}};p.setOptions(O);const j={entities:n.entities.filter((oe,U)=>oe.rangeEvents.some(A=>A.startTime.getTime()<D.getTime()&&A.endTime.getTime()>x.getTime()))};p.setData(j),p.renderCanvas()},500)}export{Co as a,ho as r};
